{% extends "base.html" %}

{% block title %}PDF Page Delete - Cropio{% endblock %}

{% block page_content %}
<link rel="stylesheet" href="{{ url_for('static', filename='pdf_converters/pdf_page_delete_simple.css') }}">

<div class="pdf-delete-container" id="pdf-page-delete-app">
    <!-- Header -->
    <header class="text-center mb-12">
        <h1 class="text-5xl md:text-6xl font-bold text-slate-900 dark:text-white">
            PDF Page <span class="text-red-600">Delete</span>
        </h1>
        <p class="mt-4 text-xl text-slate-600 dark:text-slate-400 max-w-3xl mx-auto">
            Remove unwanted pages from your PDFs with precision. Select individual pages or use batch operations for multiple files.
        </p>
    </header>

    <!-- Upload Section -->
    <section id="upload-section" class="section-card">
        <div class="text-center mb-6">
            <h2 class="text-2xl font-bold text-slate-800 dark:text-white mb-2">
                Delete PDF Pages
            </h2>
            <p class="text-slate-600 dark:text-slate-400">
                Upload single or multiple PDF files to delete pages
            </p>
        </div>

        <!-- Upload Options Toggle -->
        <div id="upload-mode-toggle" class="operation-toggle mb-6">
            <div class="toggle-option active" data-upload-mode="single">
                <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                </svg>
                Single PDF
            </div>
            <div class="toggle-option" data-upload-mode="batch">
                <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
                </svg>
                Batch Process
            </div>
        </div>

        <!-- Single File Upload -->
        <div id="single-upload" class="upload-mode-section">
            <div id="upload-zone" class="upload-zone">
                <svg class="upload-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" 
                          d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                </svg>
                <h3 class="text-xl font-semibold text-slate-700 dark:text-slate-300 mb-2">
                    Drop your PDF here
                </h3>
                <p class="text-slate-500 dark:text-slate-400 mb-4">
                    Select pages individually for precise deletion
                </p>
                <label class="upload-button">
                    Choose PDF File
                    <input type="file" id="pdf-file-input" class="hidden" accept=".pdf">
                </label>
            </div>
        </div>

        <!-- Batch Upload -->
        <div id="batch-upload" class="upload-mode-section hidden">
            <div id="batch-upload-zone" class="upload-zone">
                <svg class="upload-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" 
                          d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 12l2 2 4-4"/>
                </svg>
                <h3 class="text-xl font-semibold text-slate-700 dark:text-slate-300 mb-2">
                    Drop multiple PDFs here
                </h3>
                <p class="text-slate-500 dark:text-slate-400 mb-4">
                    Apply same deletion pattern to all files
                </p>
                <label class="upload-button">
                    Choose PDF Files
                    <input type="file" id="batch-file-input" class="hidden" accept=".pdf" multiple>
                </label>
            </div>
            
            <!-- Batch File List -->
            <div id="batch-file-list" class="space-y-2 mt-6 max-h-40 overflow-y-auto custom-scrollbar">
                <!-- Batch files will be listed here -->
            </div>
        </div>
    </section>

    <!-- Pages Selection Section -->
    <section id="pages-section" class="section-card hidden">
        <!-- Operation Mode Toggle -->
        <div class="flex items-center justify-between mb-6">
            <h2 class="text-2xl font-bold text-slate-800 dark:text-white">
                Select Pages
            </h2>
            <div id="operation-toggle" class="operation-toggle">
                <div class="toggle-option active" data-mode="delete">
                    <svg class="w-4 h-4 inline mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M6 2l2-2h4l2 2h4v2H2V2h4zM3 6h14v12a2 2 0 01-2 2H5a2 2 0 01-2-2V6z"/>
                    </svg>
                    Delete Pages
                </div>
                <div class="toggle-option" data-mode="keep">
                    <svg class="w-4 h-4 inline mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M5 13l4 4L19 7"/>
                    </svg>
                    Keep Only
                </div>
            </div>
        </div>

        <!-- Selection Controls -->
        <div id="selection-controls" class="selection-controls">
            <div class="control-group">
                <button id="select-all-btn" class="control-button btn-select">Select All</button>
                <button id="select-none-btn" class="control-button btn-select">Select None</button>
                <button id="select-odd-btn" class="control-button btn-select">Odd Pages</button>
                <button id="select-even-btn" class="control-button btn-select">Even Pages</button>
                <button id="select-range-btn" class="control-button btn-select">Custom Range</button>
            </div>
            <div class="flex-1">
                <div id="selection-info" class="info-text text-center">
                    No pages selected
                </div>
            </div>
        </div>

        <!-- Pages Grid -->
        <div id="pages-grid" class="pages-grid custom-scrollbar">
            <!-- Pages will be dynamically loaded here -->
        </div>

        <!-- Action Buttons -->
        <div class="flex flex-col sm:flex-row gap-4 justify-center items-center mt-8">
            <button id="process-btn" class="control-button btn-danger btn-disabled" disabled>
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                          d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                </svg>
                <span id="process-btn-text">Delete 0 Pages</span>
            </button>
            <button id="new-upload-btn" class="control-button btn-secondary">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                          d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"/>
                </svg>
                Upload New PDF
            </button>
        </div>
    </section>

    <!-- Batch Options Section (shown only for batch mode) -->
    <section id="batch-options-section" class="section-card hidden">
        <div class="text-center mb-6">
            <h2 class="text-2xl font-bold text-slate-800 dark:text-white mb-2">
                Batch Deletion Options
            </h2>
            <p class="text-slate-600 dark:text-slate-400">
                Choose which pages to delete from all selected files
            </p>
        </div>

        <!-- Batch Options -->
        <div class="batch-options">
            <label class="batch-option">
                <input type="radio" name="delete-pattern" value="first" class="text-indigo-600">
                <div>
                    <div class="font-medium">First Page</div>
                    <div class="text-sm text-slate-500">Remove the first page</div>
                </div>
            </label>
            <label class="batch-option">
                <input type="radio" name="delete-pattern" value="last" class="text-indigo-600">
                <div>
                    <div class="font-medium">Last Page</div>
                    <div class="text-sm text-slate-500">Remove the last page</div>
                </div>
            </label>
            <label class="batch-option">
                <input type="radio" name="delete-pattern" value="odd" class="text-indigo-600">
                <div>
                    <div class="font-medium">Odd Pages</div>
                    <div class="text-sm text-slate-500">Remove pages 1, 3, 5...</div>
                </div>
            </label>
            <label class="batch-option">
                <input type="radio" name="delete-pattern" value="even" class="text-indigo-600">
                <div>
                    <div class="font-medium">Even Pages</div>
                    <div class="text-sm text-slate-500">Remove pages 2, 4, 6...</div>
                </div>
            </label>
        </div>

        <!-- Custom Page Range -->
        <div class="mb-6">
            <label class="batch-option">
                <input type="radio" name="delete-pattern" value="custom" class="text-indigo-600">
                <div class="flex-1">
                    <div class="font-medium mb-2">Custom Pages</div>
                    <input type="text" id="custom-pages-input" 
                           class="page-range-input" 
                           placeholder="e.g., 1,3,5-7,10"
                           title="Enter page numbers separated by commas. Use hyphens for ranges.">
                    <div class="text-xs text-slate-500 mt-1">
                        Example: "1,3,5-7,10" deletes pages 1, 3, 5, 6, 7, and 10
                    </div>
                </div>
            </label>
        </div>

        <!-- Batch Process Button -->
        <div class="text-center">
            <button id="batch-process-btn" class="control-button btn-primary" disabled>
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                          d="M12 10v6m0 0l-3-3m3 3l3-3M3 17V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2z"/>
                </svg>
                Process Batch Files
            </button>
        </div>
    </section>

    <!-- Results Section -->
    <section id="results-section" class="section-card hidden">
        <h2 class="text-2xl font-bold text-center mb-6 text-slate-800 dark:text-white">
            Processing Results
        </h2>
        <div id="batch-results" class="results-grid">
            <!-- Results will be displayed here -->
        </div>
    </section>
</div>

<!-- Processing Overlay -->
<div id="processing-overlay" class="processing-overlay hidden">
    <div class="processing-spinner">
        <svg class="spinner" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A8 8 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
        </svg>
        <div id="processing-message" class="text-lg font-semibold text-slate-800 dark:text-white">
            Processing...
        </div>
    </div>
</div>

{% endblock %}

{% block page_scripts %}
<script src="{{ url_for('static', filename='js/pdf_converters/pdf_page_delete.js') }}" defer></script>
{% endblock %}
